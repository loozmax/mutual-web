{"ast":null,"code":"import { __decorate, __param } from 'tslib';\nimport { EventEmitter, Inject, Optional, ChangeDetectorRef, Input, Output, Component, ChangeDetectionStrategy, NgModule } from '@angular/core';\nimport { ALWAYS_FALSE_HANDLER, TuiMonth, TUI_FIRST_DAY, TUI_LAST_DAY, watch, TuiDestroyService, tuiDefaultProp, TuiMapperPipeModule } from '@taiga-ui/cdk';\nimport { TUI_DEFAULT_MARKER_HANDLER, TuiScrollbarModule, TuiCalendarModule } from '@taiga-ui/core';\nimport { TUI_CALENDAR_DATA_STREAM } from '@taiga-ui/kit/tokens';\nimport { Observable } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n/**\n * @internal\n */\n\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from '@taiga-ui/core';\nimport * as ɵngcc2 from '@taiga-ui/cdk';\nimport * as ɵngcc3 from 'rxjs';\nlet TuiPrimitiveCalendarRangeComponent = /*#__PURE__*/(() => {\n  let TuiPrimitiveCalendarRangeComponent = class TuiPrimitiveCalendarRangeComponent {\n    constructor(valueChanges, changeDetectorRef, destroy$) {\n      this.disabledItemHandler = ALWAYS_FALSE_HANDLER;\n      this.markerHandler = TUI_DEFAULT_MARKER_HANDLER;\n      this.defaultViewedMonthFirst = TuiMonth.currentLocal();\n      this.defaultViewedMonthSecond = TuiMonth.currentLocal().append({\n        month: 1\n      });\n      this.min = TUI_FIRST_DAY;\n      this.max = TUI_LAST_DAY;\n      this.value = null;\n      this.dayClick = new EventEmitter();\n      this.hoveredItem = null;\n      this.userViewedMonthFirst = this.defaultViewedMonthFirst;\n      this.userViewedMonthSecond = this.defaultViewedMonthSecond;\n\n      this.monthOffset = (value, offset) => value.append({\n        month: offset\n      });\n\n      if (!valueChanges) {\n        return;\n      }\n\n      valueChanges.pipe(watch(changeDetectorRef), takeUntil(destroy$)).subscribe(value => {\n        this.value = value;\n        this.updateViewedMonths();\n      });\n    }\n\n    get cappedUserViewedMonthSecond() {\n      return this.userViewedMonthSecond.monthBefore(this.max) ? this.userViewedMonthSecond : this.max;\n    }\n\n    get cappedUserViewedMonthFirst() {\n      return this.userViewedMonthFirst.monthSameOrBefore(this.userViewedMonthSecond) ? this.userViewedMonthFirst : this.userViewedMonthSecond;\n    }\n\n    ngOnInit() {\n      this.setInitialMonths();\n    }\n\n    onSectionFirstViewedMonth(month) {\n      this.userViewedMonthFirst = month;\n\n      if (this.userViewedMonthSecond.year < this.userViewedMonthFirst.year) {\n        this.userViewedMonthSecond = this.userViewedMonthSecond.append({\n          year: month.year - this.userViewedMonthSecond.year\n        });\n      }\n    }\n\n    onSectionSecondViewedMonth(month) {\n      this.userViewedMonthSecond = month;\n\n      if (this.userViewedMonthFirst.year > this.userViewedMonthSecond.year) {\n        this.userViewedMonthFirst = this.userViewedMonthFirst.append({\n          year: month.year - this.userViewedMonthFirst.year\n        });\n      }\n    }\n\n    onDayClick(day) {\n      this.dayClick.emit(day);\n    }\n\n    setInitialMonths() {\n      if (!this.value) {\n        this.userViewedMonthSecond = this.updatedViewedMonthSecond(this.defaultViewedMonthSecond);\n        this.userViewedMonthFirst = this.updatedViewedMonthFirst(this.defaultViewedMonthFirst);\n      }\n    }\n\n    updatedViewedMonthSecond(month) {\n      if (month.monthSameOrAfter(this.max)) {\n        return this.max;\n      }\n\n      if (month.monthBefore(this.min)) {\n        return this.min.append({\n          month: 1\n        });\n      }\n\n      return month;\n    }\n\n    updatedViewedMonthFirst(month) {\n      if (month.monthSameOrAfter(this.userViewedMonthSecond)) {\n        return this.userViewedMonthSecond.append({\n          month: -1\n        });\n      }\n\n      if (month.monthSameOrBefore(this.min)) {\n        return this.min;\n      }\n\n      return month;\n    }\n\n    updateViewedMonths() {\n      this.userViewedMonthFirst = this.value === null ? this.defaultViewedMonthFirst : this.value.from;\n      this.userViewedMonthSecond = this.value === null ? this.defaultViewedMonthSecond : this.value.to;\n\n      if (this.userViewedMonthFirst.monthSame(this.userViewedMonthSecond)) {\n        this.userViewedMonthSecond = this.userViewedMonthSecond.append({\n          month: 1\n        });\n      }\n    }\n\n  };\n\n  TuiPrimitiveCalendarRangeComponent.ɵfac = function TuiPrimitiveCalendarRangeComponent_Factory(t) {\n    return new (t || TuiPrimitiveCalendarRangeComponent)(ɵngcc0.ɵɵdirectiveInject(TUI_CALENDAR_DATA_STREAM, 8), ɵngcc0.ɵɵdirectiveInject(ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(TuiDestroyService));\n  };\n\n  TuiPrimitiveCalendarRangeComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: TuiPrimitiveCalendarRangeComponent,\n    selectors: [[\"tui-primitive-calendar-range\"]],\n    inputs: {\n      disabledItemHandler: \"disabledItemHandler\",\n      markerHandler: \"markerHandler\",\n      defaultViewedMonthFirst: \"defaultViewedMonthFirst\",\n      defaultViewedMonthSecond: \"defaultViewedMonthSecond\",\n      min: \"min\",\n      max: \"max\",\n      value: \"value\"\n    },\n    outputs: {\n      dayClick: \"dayClick\"\n    },\n    features: [ɵngcc0.ɵɵProvidersFeature([TuiDestroyService])],\n    decls: 4,\n    vars: 26,\n    consts: [[3, \"min\", \"max\", \"month\", \"markerHandler\", \"maxViewedMonth\", \"value\", \"disabledItemHandler\", \"showAdjacent\", \"hoveredItem\", \"hoveredItemChange\", \"dayClick\", \"monthChange\"], [1, \"border\", 3, \"min\", \"max\", \"month\", \"markerHandler\", \"minViewedMonth\", \"value\", \"disabledItemHandler\", \"showAdjacent\", \"hoveredItem\", \"hoveredItemChange\", \"dayClick\", \"monthChange\"]],\n    template: function TuiPrimitiveCalendarRangeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"tui-calendar\", 0);\n        ɵngcc0.ɵɵlistener(\"hoveredItemChange\", function TuiPrimitiveCalendarRangeComponent_Template_tui_calendar_hoveredItemChange_0_listener($event) {\n          return ctx.hoveredItem = $event;\n        })(\"dayClick\", function TuiPrimitiveCalendarRangeComponent_Template_tui_calendar_dayClick_0_listener($event) {\n          return ctx.onDayClick($event);\n        })(\"monthChange\", function TuiPrimitiveCalendarRangeComponent_Template_tui_calendar_monthChange_0_listener($event) {\n          return ctx.onSectionFirstViewedMonth($event);\n        });\n        ɵngcc0.ɵɵpipe(1, \"tuiMapper\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(2, \"tui-calendar\", 1);\n        ɵngcc0.ɵɵlistener(\"hoveredItemChange\", function TuiPrimitiveCalendarRangeComponent_Template_tui_calendar_hoveredItemChange_2_listener($event) {\n          return ctx.hoveredItem = $event;\n        })(\"dayClick\", function TuiPrimitiveCalendarRangeComponent_Template_tui_calendar_dayClick_2_listener($event) {\n          return ctx.onDayClick($event);\n        })(\"monthChange\", function TuiPrimitiveCalendarRangeComponent_Template_tui_calendar_monthChange_2_listener($event) {\n          return ctx.onSectionSecondViewedMonth($event);\n        });\n        ɵngcc0.ɵɵpipe(3, \"tuiMapper\");\n        ɵngcc0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        ɵngcc0.ɵɵproperty(\"min\", ctx.min)(\"max\", ctx.max)(\"month\", ctx.userViewedMonthFirst)(\"markerHandler\", ctx.markerHandler)(\"maxViewedMonth\", ɵngcc0.ɵɵpipeBind3(1, 18, ctx.cappedUserViewedMonthSecond, ctx.monthOffset, -1))(\"value\", ctx.value)(\"disabledItemHandler\", ctx.disabledItemHandler)(\"showAdjacent\", false)(\"hoveredItem\", ctx.hoveredItem);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"min\", ctx.min)(\"max\", ctx.max)(\"month\", ctx.userViewedMonthSecond)(\"markerHandler\", ctx.markerHandler)(\"minViewedMonth\", ɵngcc0.ɵɵpipeBind3(3, 22, ctx.cappedUserViewedMonthFirst, ctx.monthOffset, 1))(\"value\", ctx.value)(\"disabledItemHandler\", ctx.disabledItemHandler)(\"showAdjacent\", false)(\"hoveredItem\", ctx.hoveredItem);\n      }\n    },\n    directives: [ɵngcc1.TuiCalendarComponent],\n    pipes: [ɵngcc2.TuiMapperPipe],\n    styles: [\"[_nghost-%COMP%]{display:flex}.border[_ngcontent-%COMP%]{border-left:1px solid var(--tui-base-03)}\"],\n    changeDetection: 0\n  });\n\n  __decorate([Input(), tuiDefaultProp()], TuiPrimitiveCalendarRangeComponent.prototype, \"disabledItemHandler\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiPrimitiveCalendarRangeComponent.prototype, \"markerHandler\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiPrimitiveCalendarRangeComponent.prototype, \"defaultViewedMonthFirst\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiPrimitiveCalendarRangeComponent.prototype, \"defaultViewedMonthSecond\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiPrimitiveCalendarRangeComponent.prototype, \"min\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiPrimitiveCalendarRangeComponent.prototype, \"max\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiPrimitiveCalendarRangeComponent.prototype, \"value\", void 0);\n\n  __decorate([Output()], TuiPrimitiveCalendarRangeComponent.prototype, \"dayClick\", void 0);\n\n  TuiPrimitiveCalendarRangeComponent = __decorate([__param(0, Inject(TUI_CALENDAR_DATA_STREAM)), __param(0, Optional()), __param(1, Inject(ChangeDetectorRef)), __param(2, Inject(TuiDestroyService))], TuiPrimitiveCalendarRangeComponent);\n  /**\n   * @internal\n   */\n\n  return TuiPrimitiveCalendarRangeComponent;\n})();\nlet TuiPrimitiveCalendarRangeModule = /*#__PURE__*/(() => {\n  let TuiPrimitiveCalendarRangeModule = class TuiPrimitiveCalendarRangeModule {};\n\n  TuiPrimitiveCalendarRangeModule.ɵfac = function TuiPrimitiveCalendarRangeModule_Factory(t) {\n    return new (t || TuiPrimitiveCalendarRangeModule)();\n  };\n\n  TuiPrimitiveCalendarRangeModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: TuiPrimitiveCalendarRangeModule\n  });\n  TuiPrimitiveCalendarRangeModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    imports: [[TuiMapperPipeModule, TuiScrollbarModule, TuiCalendarModule]]\n  });\n  return TuiPrimitiveCalendarRangeModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(TuiPrimitiveCalendarRangeModule, {\n    declarations: function () {\n      return [TuiPrimitiveCalendarRangeComponent];\n    },\n    imports: function () {\n      return [TuiMapperPipeModule, TuiScrollbarModule, TuiCalendarModule];\n    },\n    exports: function () {\n      return [TuiPrimitiveCalendarRangeComponent];\n    }\n  });\n})();\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { TuiPrimitiveCalendarRangeComponent, TuiPrimitiveCalendarRangeModule }; //# sourceMappingURL=taiga-ui-kit-internal-primitive-calendar-range.js.map","map":null,"metadata":{},"sourceType":"module"}