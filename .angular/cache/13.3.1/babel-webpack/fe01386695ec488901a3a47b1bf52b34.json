{"ast":null,"code":"import { __decorate, __param } from 'tslib';\nimport { EventEmitter, Inject, Optional, ChangeDetectorRef, Input, Output, Component, ChangeDetectionStrategy, NgModule } from '@angular/core';\nimport { TuiMonth, ALWAYS_FALSE_HANDLER, TUI_FIRST_DAY, TUI_LAST_DAY, watch, TuiDayRange, nullableSame, TuiDestroyService, tuiDefaultProp, tuiPure, TuiMapperPipeModule, TuiPreventDefaultModule } from '@taiga-ui/cdk';\nimport { TUI_DEFAULT_MARKER_HANDLER, TuiCalendarModule, TuiSvgModule, TuiDataListModule } from '@taiga-ui/core';\nimport { MAX_DAY_RANGE_LENGTH_MAPPER } from '@taiga-ui/kit/constants';\nimport { TUI_CALENDAR_DATA_STREAM, TUI_OTHER_DATE_TEXT } from '@taiga-ui/kit/tokens';\nimport { Observable } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { CommonModule } from '@angular/common';\nimport { TuiPrimitiveCalendarRangeModule } from '@taiga-ui/kit/internal/primitive-calendar-range';\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from '@angular/common';\nimport * as ɵngcc2 from '@taiga-ui/kit/internal/primitive-calendar-range';\nimport * as ɵngcc3 from '@taiga-ui/cdk';\nimport * as ɵngcc4 from '@taiga-ui/core';\nimport * as ɵngcc5 from 'rxjs';\n\nconst _c0 = function (a0, a1, a2, a3) {\n  return [a0, a1, a2, a3, true];\n};\n\nconst _c1 = function (a0, a1, a2, a3) {\n  return [a0, a1, a2, a3, false];\n};\n\nfunction TuiCalendarRangeComponent_tui_primitive_calendar_range_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = ɵngcc0.ɵɵgetCurrentView();\n\n    ɵngcc0.ɵɵelementStart(0, \"tui-primitive-calendar-range\", 2);\n    ɵngcc0.ɵɵlistener(\"dayClick\", function TuiCalendarRangeComponent_tui_primitive_calendar_range_0_Template_tui_primitive_calendar_range_dayClick_0_listener($event) {\n      ɵngcc0.ɵɵrestoreView(_r4);\n      const ctx_r3 = ɵngcc0.ɵɵnextContext();\n      return ctx_r3.onDayClick($event);\n    });\n    ɵngcc0.ɵɵpipe(1, \"tuiMapper\");\n    ɵngcc0.ɵɵpipe(2, \"tuiMapper\");\n    ɵngcc0.ɵɵpipe(3, \"tuiMapper\");\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵproperty(\"markerHandler\", ctx_r0.markerHandler)(\"min\", ɵngcc0.ɵɵpipeBindV(1, 7, ɵngcc0.ɵɵpureFunction4(22, _c0, ctx_r0.min, ctx_r0.maxLengthMapper, ctx_r0.value, ctx_r0.maxLength)))(\"max\", ɵngcc0.ɵɵpipeBindV(2, 13, ɵngcc0.ɵɵpureFunction4(27, _c1, ctx_r0.max, ctx_r0.maxLengthMapper, ctx_r0.value, ctx_r0.maxLength)))(\"defaultViewedMonthFirst\", ctx_r0.defaultViewedMonth)(\"defaultViewedMonthSecond\", ɵngcc0.ɵɵpipeBind2(3, 19, ctx_r0.defaultViewedMonth, ctx_r0.monthShiftMapper))(\"disabledItemHandler\", ctx_r0.calculatedDisabledItemHandler)(\"value\", ctx_r0.value);\n  }\n}\n\nfunction TuiCalendarRangeComponent_ng_template_1_button_5_tui_svg_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelement(0, \"tui-svg\", 9);\n  }\n}\n\nfunction TuiCalendarRangeComponent_ng_template_1_button_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = ɵngcc0.ɵɵgetCurrentView();\n\n    ɵngcc0.ɵɵelementStart(0, \"button\", 7);\n    ɵngcc0.ɵɵlistener(\"keydown.enter.prevent\", function TuiCalendarRangeComponent_ng_template_1_button_5_Template_button_keydown_enter_prevent_0_listener() {\n      const restoredCtx = ɵngcc0.ɵɵrestoreView(_r9);\n      const item_r6 = restoredCtx.$implicit;\n      const ctx_r8 = ɵngcc0.ɵɵnextContext(2);\n      return ctx_r8.onItemSelect(item_r6);\n    })(\"keydown.space.prevent\", function TuiCalendarRangeComponent_ng_template_1_button_5_Template_button_keydown_space_prevent_0_listener() {\n      const restoredCtx = ɵngcc0.ɵɵrestoreView(_r9);\n      const item_r6 = restoredCtx.$implicit;\n      const ctx_r10 = ɵngcc0.ɵɵnextContext(2);\n      return ctx_r10.onItemSelect(item_r6);\n    })(\"click\", function TuiCalendarRangeComponent_ng_template_1_button_5_Template_button_click_0_listener() {\n      const restoredCtx = ɵngcc0.ɵɵrestoreView(_r9);\n      const item_r6 = restoredCtx.$implicit;\n      const ctx_r11 = ɵngcc0.ɵɵnextContext(2);\n      return ctx_r11.onItemSelect(item_r6);\n    });\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵtemplate(2, TuiCalendarRangeComponent_ng_template_1_button_5_tui_svg_2_Template, 1, 0, \"tui-svg\", 8);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r6 = ctx.$implicit;\n    const ctx_r5 = ɵngcc0.ɵɵnextContext(2);\n    ɵngcc0.ɵɵattribute(\"aria-checked\", ctx_r5.isItemActive(item_r6));\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", item_r6, \" \");\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngIf\", ctx_r5.isItemActive(item_r6));\n  }\n}\n\nconst _c2 = function (a0, a1, a2, a3, a4, a5) {\n  return [a0, a1, a2, a3, a4, a5];\n};\n\nfunction TuiCalendarRangeComponent_ng_template_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = ɵngcc0.ɵɵgetCurrentView();\n\n    ɵngcc0.ɵɵelementStart(0, \"div\", 3)(1, \"tui-calendar\", 4);\n    ɵngcc0.ɵɵlistener(\"dayClick\", function TuiCalendarRangeComponent_ng_template_1_Template_tui_calendar_dayClick_1_listener($event) {\n      ɵngcc0.ɵɵrestoreView(_r13);\n      const ctx_r12 = ɵngcc0.ɵɵnextContext();\n      return ctx_r12.onDayClick($event);\n    });\n    ɵngcc0.ɵɵpipe(2, \"tuiMapper\");\n    ɵngcc0.ɵɵpipe(3, \"tuiMapper\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(4, \"tui-data-list\", 5);\n    ɵngcc0.ɵɵtemplate(5, TuiCalendarRangeComponent_ng_template_1_button_5_Template, 3, 3, \"button\", 6);\n    ɵngcc0.ɵɵpipe(6, \"tuiMapper\");\n    ɵngcc0.ɵɵpipe(7, \"async\");\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"value\", ctx_r2.value)(\"markerHandler\", ctx_r2.markerHandler)(\"min\", ɵngcc0.ɵɵpipeBindV(2, 7, ɵngcc0.ɵɵpureFunction4(28, _c0, ctx_r2.min, ctx_r2.maxLengthMapper, ctx_r2.value, ctx_r2.maxLength)))(\"max\", ɵngcc0.ɵɵpipeBindV(3, 13, ɵngcc0.ɵɵpureFunction4(33, _c1, ctx_r2.max, ctx_r2.maxLengthMapper, ctx_r2.value, ctx_r2.maxLength)))(\"month\", ctx_r2.computedMonth)(\"disabledItemHandler\", ctx_r2.calculatedDisabledItemHandler);\n    ɵngcc0.ɵɵadvance(4);\n    ɵngcc0.ɵɵproperty(\"ngForOf\", ɵngcc0.ɵɵpipeBindV(6, 19, ɵngcc0.ɵɵpureFunction6(38, _c2, ctx_r2.items, ctx_r2.mapper, ctx_r2.min, ctx_r2.max, ctx_r2.minLength, ɵngcc0.ɵɵpipeBind1(7, 26, ctx_r2.otherDateText$))));\n  }\n}\n\nlet TuiCalendarRangeComponent = /*#__PURE__*/(() => {\n  let TuiCalendarRangeComponent = class TuiCalendarRangeComponent {\n    constructor(valueChanges, changeDetectorRef, destroy$, otherDateText$) {\n      this.otherDateText$ = otherDateText$;\n      this.defaultViewedMonth = TuiMonth.currentLocal();\n      this.disabledItemHandler = ALWAYS_FALSE_HANDLER;\n      this.markerHandler = TUI_DEFAULT_MARKER_HANDLER;\n      this.items = [];\n      this.min = TUI_FIRST_DAY;\n      this.max = TUI_LAST_DAY;\n      this.minLength = null;\n      this.maxLength = null;\n      this.value = null;\n      this.valueChange = new EventEmitter();\n      /** @deprecated TODO: remove in 3.0 */\n\n      this.rangeChange = new EventEmitter();\n      this.maxLengthMapper = MAX_DAY_RANGE_LENGTH_MAPPER;\n\n      this.monthShiftMapper = item => item.append({\n        month: 1\n      });\n\n      this.mapper = (items, min, max, minLength, otherDateText) => [...items.filter(item => (minLength === null || item.range.from.append(minLength).daySameOrBefore(item.range.to)) && item.range.to.daySameOrAfter(min) && (max === null || item.range.from.daySameOrBefore(max))), otherDateText];\n\n      if (!valueChanges) {\n        return;\n      }\n\n      valueChanges.pipe(watch(changeDetectorRef), takeUntil(destroy$)).subscribe(value => {\n        this.value = value;\n      });\n    }\n\n    get calculatedDisabledItemHandler() {\n      return this.calculateDisabledItemHandler(this.disabledItemHandler, this.value, this.minLength);\n    }\n\n    get computedMonth() {\n      return this.value ? this.value.to : this.defaultViewedMonth;\n    }\n\n    isItemActive(item) {\n      const {\n        activePeriod\n      } = this;\n      return typeof item === 'string' && activePeriod === null || activePeriod === item;\n    }\n\n    onRangeChange(dayRange) {\n      this.updateValue(dayRange);\n    }\n\n    onDayClick(day) {\n      const {\n        value\n      } = this;\n\n      if (value === null || !value.isSingleDay) {\n        this.value = new TuiDayRange(day, day);\n        return;\n      }\n\n      this.updateValue(TuiDayRange.sort(value.from, day));\n    }\n\n    onItemSelect(item) {\n      if (typeof item !== 'string') {\n        this.updateValue(item.range.dayLimit(this.min, this.max));\n        return;\n      }\n\n      if (this.activePeriod !== null) {\n        this.updateValue(null);\n      }\n    }\n\n    updateValue(value) {\n      this.value = value;\n      this.valueChange.emit(value);\n      this.rangeChange.emit(value);\n    }\n\n    get activePeriod() {\n      return this.items.find(item => nullableSame(this.value, item.range, (a, b) => a.from.daySame(b.from.dayLimit(this.min, this.max)) && a.to.daySame(b.to.dayLimit(this.min, this.max)))) || null;\n    }\n\n    calculateDisabledItemHandler(disabledItemHandler, value, minLength) {\n      return item => {\n        if (!value || !value.isSingleDay || !minLength) {\n          return disabledItemHandler(item);\n        }\n\n        const disabledBefore = value.from.append(minLength, true).append({\n          day: 1\n        });\n        const disabledAfter = value.from.append(minLength).append({\n          day: -1\n        });\n        const inDisabledRange = disabledBefore.dayBefore(item) && disabledAfter.dayAfter(item);\n        return inDisabledRange || disabledItemHandler(item);\n      };\n    }\n\n  };\n\n  TuiCalendarRangeComponent.ɵfac = function TuiCalendarRangeComponent_Factory(t) {\n    return new (t || TuiCalendarRangeComponent)(ɵngcc0.ɵɵdirectiveInject(TUI_CALENDAR_DATA_STREAM, 8), ɵngcc0.ɵɵdirectiveInject(ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(TuiDestroyService), ɵngcc0.ɵɵdirectiveInject(TUI_OTHER_DATE_TEXT));\n  };\n\n  TuiCalendarRangeComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: TuiCalendarRangeComponent,\n    selectors: [[\"tui-calendar-range\"]],\n    inputs: {\n      defaultViewedMonth: \"defaultViewedMonth\",\n      disabledItemHandler: \"disabledItemHandler\",\n      markerHandler: \"markerHandler\",\n      items: \"items\",\n      min: \"min\",\n      max: \"max\",\n      minLength: \"minLength\",\n      maxLength: \"maxLength\",\n      value: \"value\"\n    },\n    outputs: {\n      valueChange: \"valueChange\",\n      rangeChange: \"rangeChange\"\n    },\n    features: [ɵngcc0.ɵɵProvidersFeature([TuiDestroyService])],\n    decls: 3,\n    vars: 2,\n    consts: [[\"automation-id\", \"tui-calendar-range__calendars\", \"tuiPreventDefault\", \"mousedown\", 3, \"markerHandler\", \"min\", \"max\", \"defaultViewedMonthFirst\", \"defaultViewedMonthSecond\", \"disabledItemHandler\", \"value\", \"dayClick\", 4, \"ngIf\", \"ngIfElse\"], [\"presets\", \"\"], [\"automation-id\", \"tui-calendar-range__calendars\", \"tuiPreventDefault\", \"mousedown\", 3, \"markerHandler\", \"min\", \"max\", \"defaultViewedMonthFirst\", \"defaultViewedMonthSecond\", \"disabledItemHandler\", \"value\", \"dayClick\"], [1, \"wrapper\"], [\"automation-id\", \"tui-calendar-range__calendar\", \"tuiPreventDefault\", \"mousedown\", 3, \"value\", \"markerHandler\", \"min\", \"max\", \"month\", \"disabledItemHandler\", \"dayClick\"], [\"role\", \"menu\", \"automation-id\", \"tui-calendar-range__menu\", 1, \"menu\"], [\"tuiOption\", \"\", \"tuiPreventDefault\", \"mousedown\", \"role\", \"menuitemradio\", \"automation-id\", \"tui-calendar-range__menu__item\", 3, \"keydown.enter.prevent\", \"keydown.space.prevent\", \"click\", 4, \"ngFor\", \"ngForOf\"], [\"tuiOption\", \"\", \"tuiPreventDefault\", \"mousedown\", \"role\", \"menuitemradio\", \"automation-id\", \"tui-calendar-range__menu__item\", 3, \"keydown.enter.prevent\", \"keydown.space.prevent\", \"click\"], [\"automation-id\", \"tui-calendar-range__checkmark\", \"src\", \"tuiIconCheck\", \"class\", \"checkmark\", 4, \"ngIf\"], [\"automation-id\", \"tui-calendar-range__checkmark\", \"src\", \"tuiIconCheck\", 1, \"checkmark\"]],\n    template: function TuiCalendarRangeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵtemplate(0, TuiCalendarRangeComponent_tui_primitive_calendar_range_0_Template, 4, 32, \"tui-primitive-calendar-range\", 0);\n        ɵngcc0.ɵɵtemplate(1, TuiCalendarRangeComponent_ng_template_1_Template, 8, 45, \"ng-template\", null, 1, ɵngcc0.ɵɵtemplateRefExtractor);\n      }\n\n      if (rf & 2) {\n        const _r1 = ɵngcc0.ɵɵreference(2);\n\n        ɵngcc0.ɵɵproperty(\"ngIf\", !ctx.items.length)(\"ngIfElse\", _r1);\n      }\n    },\n    directives: [ɵngcc1.NgIf, ɵngcc2.TuiPrimitiveCalendarRangeComponent, ɵngcc3.TuiPreventDefaultDirective, ɵngcc4.TuiCalendarComponent, ɵngcc4.TuiDataListComponent, ɵngcc1.NgForOf, ɵngcc4.TuiOptionComponent, ɵngcc4.TuiSvgComponent],\n    pipes: [ɵngcc3.TuiMapperPipe, ɵngcc1.AsyncPipe],\n    styles: [\"[_nghost-%COMP%]{display:block}.wrapper[_ngcontent-%COMP%]{display:flex}.menu[_ngcontent-%COMP%]{width:11rem;border-left:1px solid var(--tui-base-03)}.checkmark[_ngcontent-%COMP%]{margin-left:auto;width:1rem;height:1rem}\"],\n    changeDetection: 0\n  });\n\n  __decorate([Input(), tuiDefaultProp()], TuiCalendarRangeComponent.prototype, \"defaultViewedMonth\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiCalendarRangeComponent.prototype, \"disabledItemHandler\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiCalendarRangeComponent.prototype, \"markerHandler\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiCalendarRangeComponent.prototype, \"items\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiCalendarRangeComponent.prototype, \"min\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiCalendarRangeComponent.prototype, \"max\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiCalendarRangeComponent.prototype, \"minLength\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiCalendarRangeComponent.prototype, \"maxLength\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiCalendarRangeComponent.prototype, \"value\", void 0);\n\n  __decorate([Output()], TuiCalendarRangeComponent.prototype, \"valueChange\", void 0);\n\n  __decorate([Output()], TuiCalendarRangeComponent.prototype, \"rangeChange\", void 0);\n\n  __decorate([tuiPure], TuiCalendarRangeComponent.prototype, \"calculateDisabledItemHandler\", null);\n\n  TuiCalendarRangeComponent = __decorate([__param(0, Inject(TUI_CALENDAR_DATA_STREAM)), __param(0, Optional()), __param(1, Inject(ChangeDetectorRef)), __param(2, Inject(TuiDestroyService)), __param(3, Inject(TUI_OTHER_DATE_TEXT))], TuiCalendarRangeComponent);\n  return TuiCalendarRangeComponent;\n})();\nlet TuiCalendarRangeModule = /*#__PURE__*/(() => {\n  let TuiCalendarRangeModule = class TuiCalendarRangeModule {};\n\n  TuiCalendarRangeModule.ɵfac = function TuiCalendarRangeModule_Factory(t) {\n    return new (t || TuiCalendarRangeModule)();\n  };\n\n  TuiCalendarRangeModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: TuiCalendarRangeModule\n  });\n  TuiCalendarRangeModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    imports: [[CommonModule, TuiMapperPipeModule, TuiPreventDefaultModule, TuiCalendarModule, TuiCalendarModule, TuiSvgModule, TuiDataListModule, TuiPrimitiveCalendarRangeModule]]\n  });\n  return TuiCalendarRangeModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(TuiCalendarRangeModule, {\n    declarations: function () {\n      return [TuiCalendarRangeComponent];\n    },\n    imports: function () {\n      return [CommonModule, TuiMapperPipeModule, TuiPreventDefaultModule, TuiCalendarModule, TuiCalendarModule, TuiSvgModule, TuiDataListModule, TuiPrimitiveCalendarRangeModule];\n    },\n    exports: function () {\n      return [TuiCalendarRangeComponent];\n    }\n  });\n})();\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { TuiCalendarRangeComponent, TuiCalendarRangeModule }; //# sourceMappingURL=taiga-ui-kit-components-calendar-range.js.map","map":null,"metadata":{},"sourceType":"module"}