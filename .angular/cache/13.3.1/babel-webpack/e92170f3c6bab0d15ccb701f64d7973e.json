{"ast":null,"code":"import { __decorate, __param } from 'tslib';\nimport { DOCUMENT, CommonModule } from '@angular/common';\nimport { InjectionToken, Inject, ElementRef, Input, HostBinding, Component, ChangeDetectionStrategy, NgZone, Directive, NgModule } from '@angular/core';\nimport { USER_AGENT, ANIMATION_FRAME } from '@ng-web-apis/common';\nimport { isEdgeOlderThan, isIE, isSafari, blurNativeFocused, isNativeFocusedIn, TUI_IS_IOS, tuiDefaultProp, tuiRequiredSetter, tuiZonefree, TuiDestroyService } from '@taiga-ui/cdk';\nimport { sizeBigger } from '@taiga-ui/core/utils/miscellaneous';\nimport { Observable } from 'rxjs';\nimport { pairwise, takeUntil } from 'rxjs/operators';\nimport { PolymorpheusModule } from '@tinkoff/ng-polymorpheus';\n/** Default values for the loader options. */\n\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from '@angular/common';\nimport * as ɵngcc2 from '@tinkoff/ng-polymorpheus';\nimport * as ɵngcc3 from 'rxjs';\n\nfunction TuiLoaderComponent_div_2_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵnamespaceSVG();\n    ɵngcc0.ɵɵnamespaceHTML();\n    ɵngcc0.ɵɵelement(0, \"div\", 6);\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = ɵngcc0.ɵɵnextContext(2);\n    ɵngcc0.ɵɵclassProp(\"t-text_horizontal\", ctx_r1.isHorizontal);\n    ɵngcc0.ɵɵproperty(\"content\", ctx_r1.textContent);\n  }\n}\n\nfunction TuiLoaderComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"div\", 2);\n    ɵngcc0.ɵɵnamespaceSVG();\n    ɵngcc0.ɵɵelementStart(1, \"svg\", 3);\n    ɵngcc0.ɵɵelement(2, \"circle\", 4);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵtemplate(3, TuiLoaderComponent_div_2_div_3_Template, 1, 3, \"div\", 5);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵclassProp(\"t-loader_horizontal\", ctx_r0.isHorizontal)(\"t-loader_inherit-color\", ctx_r0.inheritColor);\n    ɵngcc0.ɵɵattribute(\"data-tui-element-size\", ctx_r0.size);\n    ɵngcc0.ɵɵadvance(3);\n    ɵngcc0.ɵɵproperty(\"ngIf\", ctx_r0.hasText);\n  }\n}\n\nconst _c0 = [\"*\"];\nconst TUI_LOADER_DEFAULT_OPTIONS = {\n  size: 'm',\n  inheritColor: false,\n  overlay: false\n};\nconst TUI_LOADER_OPTIONS = new InjectionToken('Default parameters for loader component', {\n  factory: () => TUI_LOADER_DEFAULT_OPTIONS\n});\n\nconst tuiLoaderOptionsProvider = options => ({\n  provide: TUI_LOADER_OPTIONS,\n  useValue: Object.assign(Object.assign({}, TUI_LOADER_DEFAULT_OPTIONS), options)\n}); // @dynamic\n\n\nlet TuiLoaderComponent = /*#__PURE__*/(() => {\n  let TuiLoaderComponent = class TuiLoaderComponent {\n    constructor(documentRef, elementRef, userAgent, isIos, options) {\n      this.documentRef = documentRef;\n      this.elementRef = elementRef;\n      this.userAgent = userAgent;\n      this.isIos = isIos;\n      this.options = options;\n      this.size = this.options.size;\n      this.inheritColor = this.options.inheritColor;\n      this.overlay = this.options.overlay; // TODO: Remove null in 3.0\n\n      this.textContent = null;\n      this.loading = true;\n      this.animatedWithJs = isEdgeOlderThan(17, this.userAgent) || isIE(this.userAgent);\n      this.isApple = isSafari(this.elementRef.nativeElement) || this.isIos;\n    }\n\n    set showLoader(value) {\n      // @bad TODO: https://github.com/angular/angular/issues/32083 think of a better way\n      if (value && this.focused) {\n        blurNativeFocused(this.documentRef);\n      }\n\n      this.loading = value;\n    }\n\n    get hasOverlay() {\n      return this.overlay && this.loading;\n    }\n\n    get hasText() {\n      return !!this.textContent;\n    }\n\n    get isHorizontal() {\n      return !sizeBigger(this.size);\n    }\n\n    get focused() {\n      return isNativeFocusedIn(this.elementRef.nativeElement);\n    }\n\n  };\n\n  TuiLoaderComponent.ɵfac = function TuiLoaderComponent_Factory(t) {\n    return new (t || TuiLoaderComponent)(ɵngcc0.ɵɵdirectiveInject(DOCUMENT), ɵngcc0.ɵɵdirectiveInject(ElementRef), ɵngcc0.ɵɵdirectiveInject(USER_AGENT), ɵngcc0.ɵɵdirectiveInject(TUI_IS_IOS), ɵngcc0.ɵɵdirectiveInject(TUI_LOADER_OPTIONS));\n  };\n\n  TuiLoaderComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: TuiLoaderComponent,\n    selectors: [[\"tui-loader\"]],\n    hostVars: 4,\n    hostBindings: function TuiLoaderComponent_HostBindings(rf, ctx) {\n      if (rf & 2) {\n        ɵngcc0.ɵɵclassProp(\"_loading\", ctx.loading)(\"_animated-with-js\", ctx.animatedWithJs);\n      }\n    },\n    inputs: {\n      size: \"size\",\n      inheritColor: \"inheritColor\",\n      overlay: \"overlay\",\n      textContent: \"textContent\",\n      showLoader: \"showLoader\"\n    },\n    ngContentSelectors: _c0,\n    decls: 3,\n    vars: 6,\n    consts: [[1, \"t-content\", 3, \"disabled\"], [\"class\", \"t-loader\", 3, \"t-loader_horizontal\", \"t-loader_inherit-color\", 4, \"ngIf\"], [1, \"t-loader\"], [\"automation-id\", \"tui-loader__loader\", \"focusable\", \"false\", \"viewBox\", \"0 0 100 100\", \"xmlns\", \"http://www.w3.org/2000/svg\", 1, \"t-icon\"], [\"cx\", \"50\", \"cy\", \"50\", \"r\", \"50\", \"stroke-dasharray\", \"314\", 1, \"t-circle\"], [\"polymorpheus-outlet\", \"\", \"automation-id\", \"tui-loader__text\", \"class\", \"t-text\", 3, \"t-text_horizontal\", \"content\", 4, \"ngIf\"], [\"polymorpheus-outlet\", \"\", \"automation-id\", \"tui-loader__text\", 1, \"t-text\", 3, \"content\"]],\n    template: function TuiLoaderComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵprojectionDef();\n        ɵngcc0.ɵɵelementStart(0, \"fieldset\", 0);\n        ɵngcc0.ɵɵprojection(1);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(2, TuiLoaderComponent_div_2_Template, 4, 6, \"div\", 1);\n      }\n\n      if (rf & 2) {\n        ɵngcc0.ɵɵclassProp(\"t-content_has-overlay\", ctx.hasOverlay)(\"t-content_loading\", ctx.loading);\n        ɵngcc0.ɵɵproperty(\"disabled\", ctx.loading && !ctx.isApple);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.loading);\n      }\n    },\n    directives: function () {\n      return [ɵngcc1.NgIf, TuiLoaderDirective, ɵngcc2.PolymorpheusOutletComponent];\n    },\n    styles: [\"@-webkit-keyframes tuiLoaderDashOffset{0%,100%{stroke-dashoffset:-66}50%{stroke-dashoffset:-314}}@keyframes tuiLoaderDashOffset{0%,100%{stroke-dashoffset:-66}50%{stroke-dashoffset:-314}}@-webkit-keyframes tuiLoaderRotate{0%{transform:rotate(0)}50%{transform:rotate(1turn)}100%{transform:rotate(3turn)}}@keyframes tuiLoaderRotate{0%{transform:rotate(0)}50%{transform:rotate(1turn)}100%{transform:rotate(3turn)}}[_nghost-%COMP%]{position:relative;display:flex}._loading[_nghost-%COMP%]{overflow:hidden}.t-content[_ngcontent-%COMP%]{z-index:0;min-width:100%;height:100%;padding:0;margin:0;border:none}.t-content_has-overlay[_ngcontent-%COMP%]{opacity:.3}.t-content_loading[_ngcontent-%COMP%]{pointer-events:none}.t-loader[_ngcontent-%COMP%]{position:relative;left:-100%;display:flex;flex-direction:column;align-items:center;justify-content:center;min-width:100%;flex-shrink:0;align-self:center;color:var(--tui-text-01);stroke:var(--tui-primary);-webkit-animation:tuiFadeIn var(--tui-duration);animation:tuiFadeIn var(--tui-duration)}.t-loader.t-loader_horizontal[_ngcontent-%COMP%]{flex-direction:row}.t-loader.t-loader_inherit-color[_ngcontent-%COMP%]{color:inherit;stroke:currentColor}.t-loader[data-tui-element-size=xs][_ngcontent-%COMP%]{font-size:.75rem;stroke-width:38}.t-loader[data-tui-element-size='s'][_ngcontent-%COMP%]{font-size:1rem;stroke-width:25}.t-loader[data-tui-element-size='m'][_ngcontent-%COMP%]{font-size:1.5rem;stroke-width:17}.t-loader[data-tui-element-size='l'][_ngcontent-%COMP%]{font-size:2.5rem;stroke-width:15}.t-loader[data-tui-element-size=xl][_ngcontent-%COMP%]{font-size:3.5rem;stroke-width:14}.t-loader[data-tui-element-size=xxl][_ngcontent-%COMP%]{font-size:5rem;stroke-width:10}.t-text[_ngcontent-%COMP%]{font:var(--tui-font-text-s);color:var(--tui-text-01);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:1rem;color:inherit;max-width:100%;text-align:center;stroke-width:0}.t-text_horizontal[_ngcontent-%COMP%]{margin:0 0 0 1rem}.t-icon[_ngcontent-%COMP%]{display:block;min-width:1em;max-width:1em;min-height:1em;max-height:1em;margin:.25rem -.5em;border-radius:100%;overflow:hidden;transform:scale(1,-1)}[_nghost-%COMP%]:not(._animated-with-js)   .t-icon[_ngcontent-%COMP%]{-webkit-animation:3s linear infinite tuiLoaderRotate;animation:3s linear infinite tuiLoaderRotate}.t-circle[_ngcontent-%COMP%]{fill:none;stroke:inherit;stroke-width:inherit;-webkit-animation:3s linear infinite tuiLoaderDashOffset;animation:3s linear infinite tuiLoaderDashOffset}\"],\n    changeDetection: 0\n  });\n\n  __decorate([Input(), tuiDefaultProp()], TuiLoaderComponent.prototype, \"size\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiLoaderComponent.prototype, \"inheritColor\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiLoaderComponent.prototype, \"overlay\", void 0);\n\n  __decorate([Input(), tuiDefaultProp()], TuiLoaderComponent.prototype, \"textContent\", void 0);\n\n  __decorate([Input(), tuiRequiredSetter()], TuiLoaderComponent.prototype, \"showLoader\", null);\n\n  __decorate([HostBinding('class._loading')], TuiLoaderComponent.prototype, \"loading\", void 0);\n\n  __decorate([HostBinding('class._animated-with-js')], TuiLoaderComponent.prototype, \"animatedWithJs\", void 0);\n\n  TuiLoaderComponent = __decorate([__param(0, Inject(DOCUMENT)), __param(1, Inject(ElementRef)), __param(2, Inject(USER_AGENT)), __param(3, Inject(TUI_IS_IOS)), __param(4, Inject(TUI_LOADER_OPTIONS))], TuiLoaderComponent);\n  return TuiLoaderComponent;\n})();\nconst PERIMETER = 314;\nconst COEFFICIENT = 1.5;\n/**\n * @deprecated\n */\n\nlet TuiLoaderDirective = /*#__PURE__*/(() => {\n  let TuiLoaderDirective = class TuiLoaderDirective {\n    constructor(animationFrame$, ngZone, destroy$, elementRef, userAgent) {\n      this.elementRef = elementRef;\n      this.strokeDasharray = PERIMETER;\n      this.strokeDashoffset = 0;\n\n      if (!isEdgeOlderThan(17, userAgent) && !isIE(userAgent)) {\n        return;\n      }\n\n      animationFrame$.pipe(tuiZonefree(ngZone), pairwise(), takeUntil(destroy$)).subscribe(([cur, prev]) => {\n        this.animate(prev - cur);\n      });\n    }\n\n    animate(delta) {\n      if (this.strokeDasharray < 0) {\n        this.strokeDasharray = PERIMETER * 2;\n        this.strokeDashoffset = 0;\n      }\n\n      const strokeDasharray = Math.abs(this.strokeDasharray - PERIMETER);\n      const fps = 1000 / delta;\n      const offsetStep = 1 + Math.floor(this.strokeDasharray / PERIMETER);\n      const {\n        style\n      } = this.elementRef.nativeElement;\n      style.strokeDashoffset = String(this.strokeDashoffset);\n      style.strokeDasharray = `${PERIMETER - strokeDasharray} ${strokeDasharray}`;\n      this.strokeDasharray -= PERIMETER / COEFFICIENT / fps;\n      this.strokeDashoffset += offsetStep * PERIMETER / COEFFICIENT / fps; // this.elementRef.nativeElement.parentElement!.style.animation = 'none';\n    }\n\n  };\n\n  TuiLoaderDirective.ɵfac = function TuiLoaderDirective_Factory(t) {\n    return new (t || TuiLoaderDirective)(ɵngcc0.ɵɵdirectiveInject(ANIMATION_FRAME), ɵngcc0.ɵɵdirectiveInject(NgZone), ɵngcc0.ɵɵdirectiveInject(TuiDestroyService), ɵngcc0.ɵɵdirectiveInject(ElementRef), ɵngcc0.ɵɵdirectiveInject(USER_AGENT));\n  };\n\n  TuiLoaderDirective.ɵdir = /*@__PURE__*/ɵngcc0.ɵɵdefineDirective({\n    type: TuiLoaderDirective,\n    selectors: [[\"circle\"]],\n    features: [ɵngcc0.ɵɵProvidersFeature([TuiDestroyService])]\n  });\n  TuiLoaderDirective = __decorate([__param(0, Inject(ANIMATION_FRAME)), __param(1, Inject(NgZone)), __param(2, Inject(TuiDestroyService)), __param(3, Inject(ElementRef)), __param(4, Inject(USER_AGENT))], TuiLoaderDirective);\n  return TuiLoaderDirective;\n})();\nlet TuiLoaderModule = /*#__PURE__*/(() => {\n  let TuiLoaderModule = class TuiLoaderModule {};\n\n  TuiLoaderModule.ɵfac = function TuiLoaderModule_Factory(t) {\n    return new (t || TuiLoaderModule)();\n  };\n\n  TuiLoaderModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: TuiLoaderModule\n  });\n  TuiLoaderModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    imports: [[CommonModule, PolymorpheusModule]]\n  });\n  return TuiLoaderModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(TuiLoaderModule, {\n    declarations: function () {\n      return [TuiLoaderComponent, TuiLoaderDirective];\n    },\n    imports: function () {\n      return [CommonModule, PolymorpheusModule];\n    },\n    exports: function () {\n      return [TuiLoaderComponent];\n    }\n  });\n})();\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { TUI_LOADER_DEFAULT_OPTIONS, TUI_LOADER_OPTIONS, TuiLoaderComponent, TuiLoaderDirective, TuiLoaderModule, tuiLoaderOptionsProvider }; //# sourceMappingURL=taiga-ui-core-components-loader.js.map","map":null,"metadata":{},"sourceType":"module"}