{"ast":null,"code":"import { __decorate, __param } from 'tslib';\nimport { InjectionToken, ElementRef, Inject, HostBinding, Component, ChangeDetectionStrategy, ɵɵdefineInjectable, ɵɵinject, Injectable, Directive, NgModule } from '@angular/core';\nimport { typedFromEvent, isCurrentTarget, containsOrAfter, TuiDestroyService, TUI_IS_MOBILE, AbstractTuiDialogService, AbstractTuiDialogDirective, TuiPreventDefaultModule, TUI_DIALOGS } from '@taiga-ui/cdk';\nimport { tuiSlideInTop, tuiFadeIn } from '@taiga-ui/core/animations';\nimport { TUI_ANIMATIONS_DURATION, TUI_CLOSE_WORD } from '@taiga-ui/core/tokens';\nimport { POLYMORPHEUS_CONTEXT, PolymorpheusComponent, PolymorpheusModule } from '@tinkoff/ng-polymorpheus';\nimport { EMPTY, merge, Observable } from 'rxjs';\nimport { DOCUMENT, CommonModule } from '@angular/common';\nimport { WINDOW } from '@ng-web-apis/common';\nimport { filter, switchMapTo, take, takeUntil } from 'rxjs/operators';\nimport { TuiIdService } from '@taiga-ui/cdk/services';\nimport { TuiButtonModule } from '@taiga-ui/core/components/button';\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from '@angular/common';\nimport * as ɵngcc2 from '@tinkoff/ng-polymorpheus';\nimport * as ɵngcc3 from '@taiga-ui/core/components/button';\nimport * as ɵngcc4 from '@taiga-ui/cdk';\nimport * as ɵngcc5 from 'rxjs';\n\nfunction TuiDialogComponent_header_0_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelement(0, \"header\", 5);\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵproperty(\"content\", ctx_r0.header)(\"context\", ctx_r0.context);\n  }\n}\n\nfunction TuiDialogComponent_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = ɵngcc0.ɵɵgetCurrentView();\n\n    ɵngcc0.ɵɵtext(0);\n    ɵngcc0.ɵɵelementStart(1, \"div\", 6)(2, \"button\", 7);\n    ɵngcc0.ɵɵlistener(\"click\", function TuiDialogComponent_ng_template_4_Template_button_click_2_listener() {\n      ɵngcc0.ɵɵrestoreView(_r5);\n      const ctx_r4 = ɵngcc0.ɵɵnextContext();\n      return ctx_r4.context.$implicit.complete();\n    });\n    ɵngcc0.ɵɵtext(3, \" OK \");\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const text_r3 = ctx.$implicit;\n    ɵngcc0.ɵɵtextInterpolate1(\" \", text_r3, \" \");\n  }\n}\n\nfunction TuiDialogComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = ɵngcc0.ɵɵgetCurrentView();\n\n    ɵngcc0.ɵɵelementStart(0, \"div\", 8)(1, \"button\", 9);\n    ɵngcc0.ɵɵlistener(\"click\", function TuiDialogComponent_div_5_Template_button_click_1_listener() {\n      ɵngcc0.ɵɵrestoreView(_r7);\n      const ctx_r6 = ɵngcc0.ɵɵnextContext();\n      return ctx_r6.close();\n    });\n    ɵngcc0.ɵɵpipe(2, \"async\");\n    ɵngcc0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"title\", ɵngcc0.ɵɵpipeBind1(2, 1, ctx_r2.closeWord$));\n  }\n}\n\nconst TUI_DIALOGS_CLOSE = new InjectionToken('A stream to close dialogs', {\n  factory: () => EMPTY\n});\nconst SCROLLBAR_PLACEHOLDER = 17;\n\nfunction dialogCloseStreamFactory(documentRef, windowRef, {\n  nativeElement\n}, close$, destroy$, {\n  dismissible\n}) {\n  return dismissible ? merge(typedFromEvent(nativeElement, 'click').pipe(filter(isCurrentTarget)), typedFromEvent(documentRef, 'keydown').pipe( // TODO: iframe warning\n  filter(({\n    key,\n    target\n  }) => key === 'Escape' && target instanceof Element && (!containsOrAfter(nativeElement, target) || nativeElement.contains(target)))), typedFromEvent(documentRef, 'mousedown').pipe( // TODO: iframe warning\n  filter(({\n    target,\n    clientX\n  }) => target instanceof Element && windowRef.innerWidth - clientX > SCROLLBAR_PLACEHOLDER && !containsOrAfter(nativeElement, target)), switchMapTo(typedFromEvent(documentRef, 'mouseup').pipe(take(1), // TODO: iframe warning\n  filter(({\n    target\n  }) => target instanceof Element && !containsOrAfter(nativeElement, target))))), close$).pipe(takeUntil(destroy$)) : close$;\n}\n\nconst TUI_DIALOG_CLOSE_STREAM = new InjectionToken('Dialogs closing stream');\nconst TUI_DIALOG_PROVIDERS = [TuiDestroyService, {\n  provide: TUI_DIALOG_CLOSE_STREAM,\n  deps: [DOCUMENT, WINDOW, ElementRef, TUI_DIALOGS_CLOSE, TuiDestroyService, POLYMORPHEUS_CONTEXT],\n  useFactory: dialogCloseStreamFactory\n}];\nconst REQUIRED_ERROR = new Error('Required dialog was dismissed'); // @dynamic\n\nlet TuiDialogComponent = /*#__PURE__*/(() => {\n  let TuiDialogComponent = class TuiDialogComponent {\n    constructor(duration, isMobile, context, close$, closeWord$) {\n      this.duration = duration;\n      this.isMobile = isMobile;\n      this.context = context;\n      this.closeWord$ = closeWord$;\n      this.animation = {\n        value: '',\n        params: {\n          start: '40px',\n          duration: this.duration\n        }\n      };\n      this.fullscreenAnimation = {\n        value: '',\n        params: {\n          start: '100vh',\n          duration: this.duration\n        }\n      };\n      close$.subscribe(() => {\n        this.close();\n      });\n    }\n\n    get size() {\n      return this.context.size;\n    }\n\n    get header() {\n      return this.context.header;\n    }\n\n    get slideInTop() {\n      return this.size === 'fullscreen' || this.size === 'page' || this.isMobile ? this.fullscreenAnimation : this.animation;\n    }\n\n    close() {\n      if (this.context.required) {\n        this.context.$implicit.error(REQUIRED_ERROR);\n      } else {\n        this.context.$implicit.complete();\n      }\n    }\n\n  };\n\n  TuiDialogComponent.ɵfac = function TuiDialogComponent_Factory(t) {\n    return new (t || TuiDialogComponent)(ɵngcc0.ɵɵdirectiveInject(TUI_ANIMATIONS_DURATION), ɵngcc0.ɵɵdirectiveInject(TUI_IS_MOBILE), ɵngcc0.ɵɵdirectiveInject(POLYMORPHEUS_CONTEXT), ɵngcc0.ɵɵdirectiveInject(TUI_DIALOG_CLOSE_STREAM), ɵngcc0.ɵɵdirectiveInject(TUI_CLOSE_WORD));\n  };\n\n  TuiDialogComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: TuiDialogComponent,\n    selectors: [[\"tui-dialog\"]],\n    hostVars: 5,\n    hostBindings: function TuiDialogComponent_HostBindings(rf, ctx) {\n      if (rf & 2) {\n        ɵngcc0.ɵɵattribute(\"data-size\", ctx.size);\n        ɵngcc0.ɵɵsyntheticHostProperty(\"@tuiSlideInTop\", ctx.slideInTop)(\"@tuiFadeIn\", ctx.slideInTop);\n        ɵngcc0.ɵɵclassProp(\"_centered\", ctx.header);\n      }\n    },\n    features: [ɵngcc0.ɵɵProvidersFeature(TUI_DIALOG_PROVIDERS)],\n    decls: 6,\n    vars: 6,\n    consts: [[\"polymorpheus-outlet\", \"\", \"class\", \"t-header\", 3, \"content\", \"context\", 4, \"ngIf\"], [1, \"t-content\"], [1, \"t-heading\", 3, \"id\", \"textContent\"], [\"polymorpheus-outlet\", \"\", 3, \"context\", \"content\"], [\"class\", \"t-wrapper\", 4, \"ngIf\"], [\"polymorpheus-outlet\", \"\", 1, \"t-header\", 3, \"content\", \"context\"], [1, \"t-buttons\"], [\"tuiButton\", \"\", \"size\", \"m\", 3, \"click\"], [1, \"t-wrapper\"], [\"tuiIconButton\", \"\", \"tuiPreventDefault\", \"mousedown\", \"automation-id\", \"tui-dialog__close\", \"size\", \"s\", \"appearance\", \"\", \"icon\", \"tuiIconCloseLarge\", \"shape\", \"rounded\", 1, \"t-close\", 3, \"title\", \"click\"]],\n    template: function TuiDialogComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵtemplate(0, TuiDialogComponent_header_0_Template, 1, 2, \"header\", 0);\n        ɵngcc0.ɵɵelementStart(1, \"div\", 1);\n        ɵngcc0.ɵɵelement(2, \"h2\", 2);\n        ɵngcc0.ɵɵelementStart(3, \"section\", 3);\n        ɵngcc0.ɵɵtemplate(4, TuiDialogComponent_ng_template_4_Template, 4, 1, \"ng-template\");\n        ɵngcc0.ɵɵelementEnd()();\n        ɵngcc0.ɵɵtemplate(5, TuiDialogComponent_div_5_Template, 3, 3, \"div\", 4);\n      }\n\n      if (rf & 2) {\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.header);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"id\", ctx.context.id)(\"textContent\", ctx.context.label);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"context\", ctx.context)(\"content\", ctx.context.content);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.context.closeable);\n      }\n    },\n    directives: [ɵngcc1.NgIf, ɵngcc2.PolymorpheusOutletComponent, ɵngcc3.TuiButtonComponent, ɵngcc4.TuiPreventDefaultDirective],\n    pipes: [ɵngcc1.AsyncPipe],\n    styles: [\"[_nghost-%COMP%]{position:relative;display:flex;font:var(--tui-font-text-m);flex-direction:column;box-sizing:border-box;margin:auto;border-radius:1rem;border:40px solid transparent}[_nghost-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;box-shadow:0 1.125rem 1.875rem rgba(0,0,0,.48);content:'';border-radius:inherit;pointer-events:none}[data-size='s'][_nghost-%COMP%]{width:30rem}[data-size='s'][_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{padding:1.5rem}[data-size='s'][_nghost-%COMP%]   .t-heading[_ngcontent-%COMP%]{margin-bottom:.5rem;font:var(--tui-font-heading-5)}[data-size='m'][_nghost-%COMP%]{width:42.5rem}[data-size='m'][_nghost-%COMP%]   .t-heading[_ngcontent-%COMP%]{margin-bottom:.75rem;font:var(--tui-font-heading-4)}[data-size='l'][_nghost-%COMP%]{width:55rem}[data-size='l'][_nghost-%COMP%]   .t-heading[_ngcontent-%COMP%]{margin-bottom:1rem}[data-size=fullscreen][_nghost-%COMP%], [data-size=page][_nghost-%COMP%]{width:100vw;min-height:100%;border-radius:0;border:none;background:var(--tui-elevation-01);box-shadow:0 4rem var(--tui-base-01)}[data-size=fullscreen][_nghost-%COMP%]   .t-content[_ngcontent-%COMP%], [data-size=page][_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{padding:3rem calc(50vw - (45rem / 2))}[data-size=fullscreen][_nghost-%COMP%]   .t-heading[_ngcontent-%COMP%], [data-size=page][_nghost-%COMP%]   .t-heading[_ngcontent-%COMP%]{margin-bottom:1rem}[data-size=page][_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{padding:0}._centered[_nghost-%COMP%]{text-align:center}[_nghost-%COMP%]   tui-root._mobile[data-size][_nghost-%COMP%], tui-root._mobile   [data-size][_nghost-%COMP%]{min-width:100vw;width:100vw;max-width:100vw;border-radius:0;border:none;margin:auto 0 0}[_nghost-%COMP%]   tui-root._mobile[data-size][_nghost-%COMP%]   .t-content[_ngcontent-%COMP%], tui-root._mobile   [data-size][_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{padding:2rem 1.5rem}[_nghost-%COMP%]   tui-root._mobile[data-size][_nghost-%COMP%]   .t-heading[_ngcontent-%COMP%], tui-root._mobile   [data-size][_nghost-%COMP%]   .t-heading[_ngcontent-%COMP%]{margin-bottom:.5rem;font:var(--tui-font-heading-5)}.t-heading[_ngcontent-%COMP%]{margin:0;word-wrap:break-word;font:var(--tui-font-heading-3)}.t-heading[_ngcontent-%COMP%]:empty{display:none}.t-header[_ngcontent-%COMP%]{display:flex;border-top-left-radius:inherit;border-top-right-radius:inherit;overflow:hidden}[data-size=fullscreen][_nghost-%COMP%]   tui-root._mobile[_nghost-%COMP%]   .t-header[_ngcontent-%COMP%], tui-root._mobile   [_nghost-%COMP%]   .t-header[_ngcontent-%COMP%]{flex:1}.t-content[_ngcontent-%COMP%]{border-radius:inherit;padding:2rem;background:var(--tui-base-01)}.t-content[_ngcontent-%COMP%]:not(:first-child){border-top-left-radius:0;border-top-right-radius:0}.t-wrapper[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;order:-1}.t-close[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration,300ms);transition-timing-function:ease-in-out;position:fixed;top:1.5rem;right:1.5rem;color:var(--tui-base-01);background:rgba(104,104,104,.96)}.t-close[_ngcontent-%COMP%]:hover{background:rgba(159,159,159,.86)}[_nghost-%COMP%]:not([data-size=fullscreen])   .t-close[_ngcontent-%COMP%]{-webkit-animation:tuiFadeIn var(--tui-duration);animation:tuiFadeIn var(--tui-duration)}[_nghost-%COMP%]:not([data-size=fullscreen]).ng-animating   .t-close[_ngcontent-%COMP%]{display:none}tui-root._mobile[_nghost-%COMP%]   .t-close[_ngcontent-%COMP%], tui-root._mobile   [_nghost-%COMP%]   .t-close[_ngcontent-%COMP%]{position:absolute;top:0;right:0;background:0 0;color:var(--tui-base-06)}tui-root._mobile[_nghost-%COMP%]   .t-close[_ngcontent-%COMP%]:hover, tui-root._mobile   [_nghost-%COMP%]   .t-close[_ngcontent-%COMP%]:hover{color:var(--tui-base-07)}.t-buttons[_ngcontent-%COMP%]{margin-top:1.25rem;text-align:right}\"],\n    data: {\n      animation: [tuiSlideInTop, tuiFadeIn]\n    },\n    changeDetection: 0\n  });\n\n  __decorate([HostBinding('attr.data-size')], TuiDialogComponent.prototype, \"size\", null);\n\n  __decorate([HostBinding('class._centered')], TuiDialogComponent.prototype, \"header\", null);\n\n  __decorate([HostBinding('@tuiSlideInTop'), HostBinding('@tuiFadeIn')], TuiDialogComponent.prototype, \"slideInTop\", null);\n\n  TuiDialogComponent = __decorate([__param(0, Inject(TUI_ANIMATIONS_DURATION)), __param(1, Inject(TUI_IS_MOBILE)), __param(2, Inject(POLYMORPHEUS_CONTEXT)), __param(3, Inject(TUI_DIALOG_CLOSE_STREAM)), __param(4, Inject(TUI_CLOSE_WORD))], TuiDialogComponent);\n  return TuiDialogComponent;\n})();\nconst DIALOG = new PolymorpheusComponent(TuiDialogComponent);\nconst DEFAULT_OPTIONS = {\n  size: 'm',\n  required: false,\n  closeable: true,\n  dismissible: true,\n  label: '',\n  header: ''\n};\nlet TuiDialogService = /*#__PURE__*/(() => {\n  let TuiDialogService = class TuiDialogService extends AbstractTuiDialogService {\n    constructor() {\n      super(...arguments);\n      this.component = DIALOG;\n      this.defaultOptions = DEFAULT_OPTIONS;\n    }\n\n  };\n\n  TuiDialogService.ɵfac = /*@__PURE__*/function () {\n    let ɵTuiDialogService_BaseFactory;\n    return function TuiDialogService_Factory(t) {\n      return (ɵTuiDialogService_BaseFactory || (ɵTuiDialogService_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(TuiDialogService)))(t || TuiDialogService);\n    };\n  }();\n\n  TuiDialogService.ɵprov = ɵɵdefineInjectable({\n    factory: function TuiDialogService_Factory() {\n      return new TuiDialogService(ɵɵinject(TuiIdService));\n    },\n    token: TuiDialogService,\n    providedIn: \"root\"\n  });\n  return TuiDialogService;\n})();\nlet TuiDialogDirective = /*#__PURE__*/(() => {\n  let TuiDialogDirective = class TuiDialogDirective extends AbstractTuiDialogDirective {};\n\n  TuiDialogDirective.ɵfac = /*@__PURE__*/function () {\n    let ɵTuiDialogDirective_BaseFactory;\n    return function TuiDialogDirective_Factory(t) {\n      return (ɵTuiDialogDirective_BaseFactory || (ɵTuiDialogDirective_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(TuiDialogDirective)))(t || TuiDialogDirective);\n    };\n  }();\n\n  TuiDialogDirective.ɵdir = /*@__PURE__*/ɵngcc0.ɵɵdefineDirective({\n    type: TuiDialogDirective,\n    selectors: [[\"ng-template\", \"tuiDialog\", \"\"]],\n    inputs: {\n      options: [\"tuiDialogOptions\", \"options\"],\n      open: [\"tuiDialog\", \"open\"]\n    },\n    outputs: {\n      openChange: \"tuiDialogChange\"\n    },\n    features: [ɵngcc0.ɵɵProvidersFeature([{\n      provide: AbstractTuiDialogService,\n      useExisting: TuiDialogService\n    }]), ɵngcc0.ɵɵInheritDefinitionFeature]\n  });\n  return TuiDialogDirective;\n})();\nlet TuiDialogModule = /*#__PURE__*/(() => {\n  let TuiDialogModule = class TuiDialogModule {};\n\n  TuiDialogModule.ɵfac = function TuiDialogModule_Factory(t) {\n    return new (t || TuiDialogModule)();\n  };\n\n  TuiDialogModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: TuiDialogModule\n  });\n  TuiDialogModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    providers: [{\n      provide: TUI_DIALOGS,\n      useExisting: TuiDialogService,\n      multi: true\n    }],\n    imports: [[PolymorpheusModule, TuiButtonModule, CommonModule, TuiPreventDefaultModule]]\n  });\n  return TuiDialogModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(TuiDialogModule, {\n    declarations: function () {\n      return [TuiDialogComponent, TuiDialogDirective];\n    },\n    imports: function () {\n      return [PolymorpheusModule, TuiButtonModule, CommonModule, TuiPreventDefaultModule];\n    },\n    exports: function () {\n      return [TuiDialogComponent, TuiDialogDirective];\n    }\n  });\n})();\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { TUI_DIALOGS_CLOSE, TUI_DIALOG_CLOSE_STREAM, TUI_DIALOG_PROVIDERS, TuiDialogComponent, TuiDialogDirective, TuiDialogModule, TuiDialogService, dialogCloseStreamFactory }; //# sourceMappingURL=taiga-ui-core-components-dialog.js.map","map":null,"metadata":{},"sourceType":"module"}